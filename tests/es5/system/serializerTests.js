"use strict";
var Serializer = require("../../../").system.Serializer;
var util = require("util");
var assert = require("assert");
var _ = require("lodash");
describe("Serialize", function() {
  it("should serialize circular objects", function() {
    var ser = new Serializer();
    var a = {b: 5};
    a.c = a;
    var c = {
      b: 1,
      a: a,
      m: [1, 2, a]
    };
    c.d = a;
    c.x = c.m;
    var array = [a, c, a, null];
    var a2 = ser.parse(ser.stringify(a));
    var c2 = ser.fromJSON(ser.toJSON(c));
    var array2 = ser.parse(ser.stringify(array));
    assert.equal(a2.b, a.b);
    assert.equal(a2.c, a2);
    assert.equal(c2.b, c.b);
    assert.strictEqual(c2.d, c2.a);
    assert.ok(Array.isArray(c2.m));
    assert.equal(c2.m.length, c.m.length);
    assert.equal(c2.m[0], c.m[0]);
    assert.equal(c2.m[1], c.m[1]);
    assert.strictEqual(c2.m[2], c2.a);
    assert.strictEqual(c2.x, c2.m);
    assert.ok(Array.isArray(array2));
    assert.equal(array2.length, array.length);
    assert.equal(array2[0].b, a.b);
    assert.strictEqual(array2[0].c, array2[0]);
    assert.strictEqual(array2[2], array2[0]);
    assert.strictEqual(array2[3], null);
    var c3 = array2[1];
    assert.equal(c3.m.length, c.m.length);
    assert.equal(c3.m[0], c.m[0]);
    assert.equal(c3.m[1], c.m[1]);
    assert.strictEqual(c3.m[2], c3.a);
    assert.strictEqual(c3.m[2], array2[0]);
    assert.strictEqual(c3.m[2], array2[2]);
  });
  it("should serialize class hieararchies", function() {
    function Animal() {
      this.voice = null;
    }
    Animal.prototype.makeSound = function() {
      if (this.voice) {
        return "I say: " + this.voice + ".";
      }
    };
    function Cat() {
      Animal.call(this);
      this.voice = "meow";
    }
    util.inherits(Cat, Animal);
    function Dog() {
      Animal.call(this);
      this.voice = "bark";
    }
    util.inherits(Dog, Animal);
    function SpaceDog() {
      Dog.call(this);
      this.voice = "42";
    }
    util.inherits(SpaceDog, Dog);
    var cat = new Cat();
    var dog = new Dog();
    var spaceDog = new SpaceDog();
    spaceDog.futureStuff = function() {
      return "I think, therefore I am.";
    };
    assert.equal(cat.makeSound(), "I say: meow.");
    assert.equal(dog.makeSound(), "I say: bark.");
    assert.equal(spaceDog.makeSound(), "I say: 42.");
    assert.equal(spaceDog.futureStuff(), "I think, therefore I am.");
    assert.ok(cat instanceof Animal);
    assert.ok(cat instanceof Cat);
    assert.ok(dog instanceof Animal);
    assert.ok(dog instanceof Dog);
    assert.ok(spaceDog instanceof Animal);
    assert.ok(spaceDog instanceof Dog);
    assert.ok(spaceDog instanceof SpaceDog);
    var ser = new Serializer();
    ser.registerKnownType("Cat", Cat);
    ser.registerKnownType("Dog", Dog);
    ser.registerKnownType("SpaceDog", SpaceDog);
    var data = ser.stringify({
      cat: cat,
      dog: dog,
      spaceDog: spaceDog
    });
    assert.ok(typeof data === "string");
    var deserialized = ser.parse(data);
    assert.equal(deserialized.cat.makeSound(), "I say: meow.");
    assert.equal(deserialized.dog.makeSound(), "I say: bark.");
    assert.equal(deserialized.spaceDog.makeSound(), "I say: 42.");
    assert.equal(deserialized.spaceDog.futureStuff(), "I think, therefore I am.");
    assert.ok(deserialized.cat instanceof Animal);
    assert.ok(deserialized.cat instanceof Cat);
    assert.ok(deserialized.dog instanceof Animal);
    assert.ok(deserialized.dog instanceof Dog);
    assert.ok(deserialized.spaceDog instanceof Animal);
    assert.ok(deserialized.spaceDog instanceof Dog);
    assert.ok(deserialized.spaceDog instanceof SpaceDog);
  });
  it("should support custom serialization", function() {
    var constructed = 0;
    function Foo() {
      this.a = "a";
      this.b = "b";
    }
    function Boo() {
      Foo.call(this);
      this.c = "c";
      constructed++;
    }
    util.inherits(Boo, Foo);
    Boo.prototype.serializeToJSON = function() {
      return {
        a: this.a,
        b: this.b,
        c: this.c
      };
    };
    Boo.prototype.deserializeFromJSON = function(json) {
      this.a = json.a;
      this.b = json.b;
      this.c = json.c;
      this.boo = "boo";
    };
    var ser = new Serializer();
    ser.registerKnownType("Boo", Boo);
    var boo = new Boo();
    assert.equal(constructed, 1);
    assert.equal(boo.a, "a");
    assert.equal(boo.b, "b");
    assert.equal(boo.c, "c");
    assert.strictEqual(boo.boo, undefined);
    var boo2 = ser.fromJSON(ser.toJSON(boo));
    assert.equal(constructed, 1);
    assert.equal(boo2.a, "a");
    assert.equal(boo2.b, "b");
    assert.equal(boo2.c, "c");
    assert.strictEqual(boo2.boo, "boo");
    assert.ok(boo2 instanceof Boo);
    assert.ok(boo2 instanceof Foo);
    var map = new Map();
    var foo = new Foo();
    map.set(foo, boo);
    map.set(boo2, foo);
    ser.registerKnownType("Foo", Foo);
    var mapStr = ser.stringify(map);
    var map2 = ser.parse(mapStr);
    assert.equal(constructed, 1);
    assert.equal(map2.size, 2);
    var fooValue = null;
    var fooKey = null;
    map2.forEach(function(key, value) {
      if (key instanceof Boo) {
        assert.ok(value instanceof Foo && !(value instanceof Boo));
        fooValue = value;
      } else if (key instanceof Foo) {
        assert.ok(value instanceof Boo);
        assert.equal(value.boo, "boo");
        fooKey = key;
      } else {
        assert.fail("This is not possible.");
      }
    });
    assert.strictEqual(fooKey, fooValue);
  });
  it("should support Map", function() {
    var map = new Map();
    map.set("a", "b");
    map.set("c", "d");
    var ser = new Serializer();
    var data = ser.toJSON(map);
    var otherMap = ser.fromJSON(data);
    assert.ok(otherMap instanceof Map);
    assert.equal(otherMap.size, 2);
    assert.equal(otherMap.get("a"), map.get("a"));
    assert.equal(otherMap.get("c"), map.get("c"));
  });
  it("should support Set", function() {
    var set = new Set();
    set.add("a");
    set.add("b");
    set.add("c");
    set.add(["d", {e: "f"}]);
    var ser = new Serializer();
    var data = ser.toJSON(set);
    var otherSet = ser.fromJSON(data);
    assert.ok(otherSet instanceof Set);
    assert.equal(otherSet.size, 4);
    assert(otherSet.has("a"));
    assert(otherSet.has("b"));
    assert(otherSet.has("c"));
    var all = [];
    var $__4 = true;
    var $__5 = false;
    var $__6 = undefined;
    try {
      for (var $__2 = void 0,
          $__1 = (otherSet.values())[$traceurRuntime.toProperty(Symbol.iterator)](); !($__4 = ($__2 = $__1.next()).done); $__4 = true) {
        var item = $__2.value;
        {
          all.push(item);
        }
      }
    } catch ($__7) {
      $__5 = true;
      $__6 = $__7;
    } finally {
      try {
        if (!$__4 && $__1.return != null) {
          $__1.return();
        }
      } finally {
        if ($__5) {
          throw $__6;
        }
      }
    }
    var obj = _(all).filter(function(i) {
      return _.isArray(i);
    }).first();
    assert(_.isArray(obj));
    assert.equal(obj[0], "d");
    assert(_.isObject(obj[1]));
    assert.equal(obj[1].e, "f");
  });
  it("should support Date", function() {
    var obj = {a: new Date()};
    var ser = new Serializer();
    var data = ser.toJSON(obj);
    var otherObj = ser.fromJSON(data);
    assert(_.isPlainObject(otherObj));
    assert(_.isDate(otherObj.a));
    assert.equal(otherObj.a.getTime(), obj.a.getTime());
  });
  it("should support Regex", function() {
    var obj = {a: /abc/g};
    var ser = new Serializer();
    var data = ser.toJSON(obj);
    var otherObj = ser.fromJSON(data);
    assert(_.isPlainObject(otherObj));
    assert(_.isRegExp(otherObj.a));
    assert.equal(otherObj.a.toString(), obj.a.toString());
  });
  it("should serialize functions", function() {
    var f = function() {
      return "Hello!";
    };
    var ser = new Serializer();
    var data = ser.toJSON(f);
    assert(_.isPlainObject(data));
    var otherF = ser.fromJSON(data);
    assert(_.isFunction(otherF));
    assert.equal("Hello!", otherF());
  });
  it("should serialize function properties", function() {
    var f = function() {
      return "Hello!";
    };
    var obj = {f: f};
    var ser = new Serializer();
    var data = ser.toJSON(obj);
    assert(_.isPlainObject(data));
    var otherObj = ser.fromJSON(data);
    assert(_.isFunction(otherObj.f));
    assert.equal("Hello!", otherObj.f());
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcmlhbGl6ZXJUZXN0cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUlBLEFBQUksRUFBQSxDQUFBLFVBQVMsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFdBQVUsQ0FBQyxPQUFPLFdBQVcsQ0FBQztBQUN2RCxBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxNQUFLLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUM5QixBQUFJLEVBQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUV6QixPQUFPLEFBQUMsQ0FBQyxXQUFVLENBQUcsVUFBVSxBQUFEO0FBQzNCLEdBQUMsQUFBQyxDQUFDLG1DQUFrQyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2hELEFBQUksTUFBQSxDQUFBLEdBQUUsRUFBSSxJQUFJLFdBQVMsQUFBQyxFQUFDLENBQUM7QUFFMUIsQUFBSSxNQUFBLENBQUEsQ0FBQSxFQUFJLEVBQUUsQ0FBQSxDQUFHLEVBQUEsQ0FBRSxDQUFDO0FBQ2hCLElBQUEsRUFBRSxFQUFJLEVBQUEsQ0FBQztBQUNQLEFBQUksTUFBQSxDQUFBLENBQUEsRUFBSTtBQUFFLE1BQUEsQ0FBRyxFQUFBO0FBQUcsTUFBQSxDQUFHLEVBQUE7QUFBRyxNQUFBLENBQUcsRUFBQyxDQUFBLENBQUcsRUFBQSxDQUFHLEVBQUEsQ0FBQztBQUFBLElBQUUsQ0FBQztBQUNwQyxJQUFBLEVBQUUsRUFBSSxFQUFBLENBQUM7QUFDUCxJQUFBLEVBQUUsRUFBSSxDQUFBLENBQUEsRUFBRSxDQUFDO0FBRVQsQUFBSSxNQUFBLENBQUEsS0FBSSxFQUFJLEVBQUMsQ0FBQSxDQUFHLEVBQUEsQ0FBRyxFQUFBLENBQUcsS0FBRyxDQUFDLENBQUM7QUFFM0IsQUFBSSxNQUFBLENBQUEsRUFBQyxFQUFJLENBQUEsR0FBRSxNQUFNLEFBQUMsQ0FBQyxHQUFFLFVBQVUsQUFBQyxDQUFDLENBQUEsQ0FBQyxDQUFDLENBQUM7QUFDcEMsQUFBSSxNQUFBLENBQUEsRUFBQyxFQUFJLENBQUEsR0FBRSxTQUFTLEFBQUMsQ0FBQyxHQUFFLE9BQU8sQUFBQyxDQUFDLENBQUEsQ0FBQyxDQUFDLENBQUM7QUFDcEMsQUFBSSxNQUFBLENBQUEsTUFBSyxFQUFJLENBQUEsR0FBRSxNQUFNLEFBQUMsQ0FBQyxHQUFFLFVBQVUsQUFBQyxDQUFDLEtBQUksQ0FBQyxDQUFDLENBQUM7QUFFNUMsU0FBSyxNQUFNLEFBQUMsQ0FBQyxFQUFDLEVBQUUsQ0FBRyxDQUFBLENBQUEsRUFBRSxDQUFDLENBQUM7QUFDdkIsU0FBSyxNQUFNLEFBQUMsQ0FBQyxFQUFDLEVBQUUsQ0FBRyxHQUFDLENBQUMsQ0FBQztBQUV0QixTQUFLLE1BQU0sQUFBQyxDQUFDLEVBQUMsRUFBRSxDQUFHLENBQUEsQ0FBQSxFQUFFLENBQUMsQ0FBQztBQUN2QixTQUFLLFlBQVksQUFBQyxDQUFDLEVBQUMsRUFBRSxDQUFHLENBQUEsRUFBQyxFQUFFLENBQUMsQ0FBQztBQUM5QixTQUFLLEdBQUcsQUFBQyxDQUFDLEtBQUksUUFBUSxBQUFDLENBQUMsRUFBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzlCLFNBQUssTUFBTSxBQUFDLENBQUMsRUFBQyxFQUFFLE9BQU8sQ0FBRyxDQUFBLENBQUEsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNyQyxTQUFLLE1BQU0sQUFBQyxDQUFDLEVBQUMsRUFBRSxDQUFFLENBQUEsQ0FBQyxDQUFHLENBQUEsQ0FBQSxFQUFFLENBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQztBQUM3QixTQUFLLE1BQU0sQUFBQyxDQUFDLEVBQUMsRUFBRSxDQUFFLENBQUEsQ0FBQyxDQUFHLENBQUEsQ0FBQSxFQUFFLENBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQztBQUM3QixTQUFLLFlBQVksQUFBQyxDQUFDLEVBQUMsRUFBRSxDQUFFLENBQUEsQ0FB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dCI6InRlc3RzL2VzNiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuLyogZ2xvYmFsIGRlc2NyaWJlLGl0ICovXHJcblxyXG5sZXQgU2VyaWFsaXplciA9IHJlcXVpcmUoXCIuLi8uLi8uLi9cIikuc3lzdGVtLlNlcmlhbGl6ZXI7XHJcbmxldCB1dGlsID0gcmVxdWlyZShcInV0aWxcIik7XHJcbmxldCBhc3NlcnQgPSByZXF1aXJlKFwiYXNzZXJ0XCIpO1xyXG5sZXQgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XHJcblxyXG5kZXNjcmliZShcIlNlcmlhbGl6ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpdChcInNob3VsZCBzZXJpYWxpemUgY2lyY3VsYXIgb2JqZWN0c1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IHNlciA9IG5ldyBTZXJpYWxpemVyKCk7XHJcblxyXG4gICAgICAgIGxldCBhID0geyBiOiA1IH07XHJcbiAgICAgICAgYS5jID0gYTtcclxuICAgICAgICBsZXQgYyA9IHsgYjogMSwgYTogYSwgbTogWzEsIDIsIGFdIH07XHJcbiAgICAgICAgYy5kID0gYTtcclxuICAgICAgICBjLnggPSBjLm07XHJcblxyXG4gICAgICAgIGxldCBhcnJheSA9IFthLCBjLCBhLCBudWxsXTtcclxuXHJcbiAgICAgICAgbGV0IGEyID0gc2VyLnBhcnNlKHNlci5zdHJpbmdpZnkoYSkpO1xyXG4gICAgICAgIGxldCBjMiA9IHNlci5mcm9tSlNPTihzZXIudG9KU09OKGMpKTtcclxuICAgICAgICBsZXQgYXJyYXkyID0gc2VyLnBhcnNlKHNlci5zdHJpbmdpZnkoYXJyYXkpKTtcclxuXHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGEyLmIsIGEuYik7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGEyLmMsIGEyKTtcclxuXHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGMyLmIsIGMuYik7XHJcbiAgICAgICAgYXNzZXJ0LnN0cmljdEVxdWFsKGMyLmQsIGMyLmEpO1xyXG4gICAgICAgIGFzc2VydC5vayhBcnJheS5pc0FycmF5KGMyLm0pKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYzIubS5sZW5ndGgsIGMubS5sZW5ndGgpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChjMi5tWzBdLCBjLm1bMF0pO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChjMi5tWzFdLCBjLm1bMV0pO1xyXG4gICAgICAgIGFzc2VydC5zdHJpY3RFcXVhbChjMi5tWzJdLCBjMi5hKTtcclxuICAgICAgICBhc3NlcnQuc3RyaWN0RXF1YWwoYzIueCwgYzIubSk7XHJcblxyXG4gICAgICAgIGFzc2VydC5vayhBcnJheS5pc0FycmF5KGFycmF5MikpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChhcnJheTIubGVuZ3RoLCBhcnJheS5sZW5ndGgpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChhcnJheTJbMF0uYiwgYS5iKTtcclxuICAgICAgICBhc3NlcnQuc3RyaWN0RXF1YWwoYXJyYXkyWzBdLmMsIGFycmF5MlswXSk7XHJcbiAgICAgICAgYXNzZXJ0LnN0cmljdEVxdWFsKGFycmF5MlsyXSwgYXJyYXkyWzBdKTtcclxuICAgICAgICBhc3NlcnQuc3RyaWN0RXF1YWwoYXJyYXkyWzNdLCBudWxsKTtcclxuICAgICAgICBsZXQgYzMgPSBhcnJheTJbMV07XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGMzLm0ubGVuZ3RoLCBjLm0ubGVuZ3RoKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYzMubVswXSwgYy5tWzBdKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYzMubVsxXSwgYy5tWzFdKTtcclxuICAgICAgICBhc3NlcnQuc3RyaWN0RXF1YWwoYzMubVsyXSwgYzMuYSk7XHJcbiAgICAgICAgYXNzZXJ0LnN0cmljdEVxdWFsKGMzLm1bMl0sIGFycmF5MlswXSk7XHJcbiAgICAgICAgYXNzZXJ0LnN0cmljdEVxdWFsKGMzLm1bMl0sIGFycmF5MlsyXSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdChcInNob3VsZCBzZXJpYWxpemUgY2xhc3MgaGllYXJhcmNoaWVzXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmdW5jdGlvbiBBbmltYWwoKSB7XHJcbiAgICAgICAgICAgIHRoaXMudm9pY2UgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgQW5pbWFsLnByb3RvdHlwZS5tYWtlU291bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZvaWNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJJIHNheTogXCIgKyB0aGlzLnZvaWNlICsgXCIuXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBDYXQoKSB7XHJcbiAgICAgICAgICAgIEFuaW1hbC5jYWxsKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLnZvaWNlID0gXCJtZW93XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1dGlsLmluaGVyaXRzKENhdCwgQW5pbWFsKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRG9nKCkge1xyXG4gICAgICAgICAgICBBbmltYWwuY2FsbCh0aGlzKTtcclxuICAgICAgICAgICAgdGhpcy52b2ljZSA9IFwiYmFya1wiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdXRpbC5pbmhlcml0cyhEb2csIEFuaW1hbCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFNwYWNlRG9nKCkge1xyXG4gICAgICAgICAgICBEb2cuY2FsbCh0aGlzKTtcclxuICAgICAgICAgICAgdGhpcy52b2ljZSA9IFwiNDJcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHV0aWwuaW5oZXJpdHMoU3BhY2VEb2csIERvZyk7XHJcblxyXG4gICAgICAgIGxldCBjYXQgPSBuZXcgQ2F0KCk7XHJcbiAgICAgICAgbGV0IGRvZyA9IG5ldyBEb2coKTtcclxuICAgICAgICBsZXQgc3BhY2VEb2cgPSBuZXcgU3BhY2VEb2coKTtcclxuICAgICAgICAvLyBBZGQgYW4gaW5zdGFuY2Utb25seSBmdW5jdGlvbjpcclxuICAgICAgICBzcGFjZURvZy5mdXR1cmVTdHVmZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiSSB0aGluaywgdGhlcmVmb3JlIEkgYW0uXCI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNhdC5tYWtlU291bmQoKSwgXCJJIHNheTogbWVvdy5cIik7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGRvZy5tYWtlU291bmQoKSwgXCJJIHNheTogYmFyay5cIik7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKHNwYWNlRG9nLm1ha2VTb3VuZCgpLCBcIkkgc2F5OiA0Mi5cIik7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKHNwYWNlRG9nLmZ1dHVyZVN0dWZmKCksIFwiSSB0aGluaywgdGhlcmVmb3JlIEkgYW0uXCIpO1xyXG4gICAgICAgIGFzc2VydC5vayhjYXQgaW5zdGFuY2VvZiBBbmltYWwpO1xyXG4gICAgICAgIGFzc2VydC5vayhjYXQgaW5zdGFuY2VvZiBDYXQpO1xyXG4gICAgICAgIGFzc2VydC5vayhkb2cgaW5zdGFuY2VvZiBBbmltYWwpO1xyXG4gICAgICAgIGFzc2VydC5vayhkb2cgaW5zdGFuY2VvZiBEb2cpO1xyXG4gICAgICAgIGFzc2VydC5vayhzcGFjZURvZyBpbnN0YW5jZW9mIEFuaW1hbCk7XHJcbiAgICAgICAgYXNzZXJ0Lm9rKHNwYWNlRG9nIGluc3RhbmNlb2YgRG9nKTtcclxuICAgICAgICBhc3NlcnQub2soc3BhY2VEb2cgaW5zdGFuY2VvZiBTcGFjZURvZyk7XHJcblxyXG4gICAgICAgIGxldCBzZXIgPSBuZXcgU2VyaWFsaXplcigpO1xyXG4gICAgICAgIHNlci5yZWdpc3Rlcktub3duVHlwZShcIkNhdFwiLCBDYXQpO1xyXG4gICAgICAgIHNlci5yZWdpc3Rlcktub3duVHlwZShcIkRvZ1wiLCBEb2cpO1xyXG4gICAgICAgIHNlci5yZWdpc3Rlcktub3duVHlwZShcIlNwYWNlRG9nXCIsIFNwYWNlRG9nKTtcclxuXHJcbiAgICAgICAgbGV0IGRhdGEgPSBzZXIuc3RyaW5naWZ5KFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjYXQ6IGNhdCxcclxuICAgICAgICAgICAgICAgIGRvZzogZG9nLFxyXG4gICAgICAgICAgICAgICAgc3BhY2VEb2c6IHNwYWNlRG9nXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBhc3NlcnQub2sodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpO1xyXG5cclxuICAgICAgICBsZXQgZGVzZXJpYWxpemVkID0gc2VyLnBhcnNlKGRhdGEpO1xyXG5cclxuICAgICAgICBhc3NlcnQuZXF1YWwoZGVzZXJpYWxpemVkLmNhdC5tYWtlU291bmQoKSwgXCJJIHNheTogbWVvdy5cIik7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGRlc2VyaWFsaXplZC5kb2cubWFrZVNvdW5kKCksIFwiSSBzYXk6IGJhcmsuXCIpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChkZXNlcmlhbGl6ZWQuc3BhY2VEb2cubWFrZVNvdW5kKCksIFwiSSBzYXk6IDQyLlwiKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoZGVzZXJpYWxpemVkLnNwYWNlRG9nLmZ1dHVyZVN0dWZmKCksIFwiSSB0aGluaywgdGhlcmVmb3JlIEkgYW0uXCIpO1xyXG4gICAgICAgIGFzc2VydC5vayhkZXNlcmlhbGl6ZWQuY2F0IGluc3RhbmNlb2YgQW5pbWFsKTtcclxuICAgICAgICBhc3NlcnQub2soZGVzZXJpYWxpemVkLmNhdCBpbnN0YW5jZW9mIENhdCk7XHJcbiAgICAgICAgYXNzZXJ0Lm9rKGRlc2VyaWFsaXplZC5kb2cgaW5zdGFuY2VvZiBBbmltYWwpO1xyXG4gICAgICAgIGFzc2VydC5vayhkZXNlcmlhbGl6ZWQuZG9nIGluc3RhbmNlb2YgRG9nKTtcclxuICAgICAgICBhc3NlcnQub2soZGVzZXJpYWxpemVkLnNwYWNlRG9nIGluc3RhbmNlb2YgQW5pbWFsKTtcclxuICAgICAgICBhc3NlcnQub2soZGVzZXJpYWxpemVkLnNwYWNlRG9nIGluc3RhbmNlb2YgRG9nKTtcclxuICAgICAgICBhc3NlcnQub2soZGVzZXJpYWxpemVkLnNwYWNlRG9nIGluc3RhbmNlb2YgU3BhY2VEb2cpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoXCJzaG91bGQgc3VwcG9ydCBjdXN0b20gc2VyaWFsaXphdGlvblwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGNvbnN0cnVjdGVkID0gMDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRm9vKCkge1xyXG4gICAgICAgICAgICB0aGlzLmEgPSBcImFcIjtcclxuICAgICAgICAgICAgdGhpcy5iID0gXCJiXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCb28oKSB7XHJcbiAgICAgICAgICAgIEZvby5jYWxsKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmMgPSBcImNcIjtcclxuICAgICAgICAgICAgY29uc3RydWN0ZWQrKztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHV0aWwuaW5oZXJpdHMoQm9vLCBGb28pO1xyXG5cclxuICAgICAgICBCb28ucHJvdG90eXBlLnNlcmlhbGl6ZVRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGE6IHRoaXMuYSxcclxuICAgICAgICAgICAgICAgIGI6IHRoaXMuYixcclxuICAgICAgICAgICAgICAgIGM6IHRoaXMuY1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIEJvby5wcm90b3R5cGUuZGVzZXJpYWxpemVGcm9tSlNPTiA9IGZ1bmN0aW9uIChqc29uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYSA9IGpzb24uYTtcclxuICAgICAgICAgICAgdGhpcy5iID0ganNvbi5iO1xyXG4gICAgICAgICAgICB0aGlzLmMgPSBqc29uLmM7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vID0gXCJib29cIjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsZXQgc2VyID0gbmV3IFNlcmlhbGl6ZXIoKTtcclxuICAgICAgICBzZXIucmVnaXN0ZXJLbm93blR5cGUoXCJCb29cIiwgQm9vKTtcclxuXHJcbiAgICAgICAgbGV0IGJvbyA9IG5ldyBCb28oKTtcclxuXHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNvbnN0cnVjdGVkLCAxKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYm9vLmEsIFwiYVwiKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYm9vLmIsIFwiYlwiKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYm9vLmMsIFwiY1wiKTtcclxuICAgICAgICBhc3NlcnQuc3RyaWN0RXF1YWwoYm9vLmJvbywgdW5kZWZpbmVkKTtcclxuXHJcbiAgICAgICAgbGV0IGJvbzIgPSBzZXIuZnJvbUpTT04oc2VyLnRvSlNPTihib28pKTtcclxuXHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNvbnN0cnVjdGVkLCAxKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoYm9vMi5hLCBcImFcIik7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGJvbzIuYiwgXCJiXCIpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChib28yLmMsIFwiY1wiKTtcclxuICAgICAgICBhc3NlcnQuc3RyaWN0RXF1YWwoYm9vMi5ib28sIFwiYm9vXCIpO1xyXG4gICAgICAgIGFzc2VydC5vayhib28yIGluc3RhbmNlb2YgQm9vKTtcclxuICAgICAgICBhc3NlcnQub2soYm9vMiBpbnN0YW5jZW9mIEZvbyk7XHJcblxyXG4gICAgICAgIGxldCBtYXAgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgbGV0IGZvbyA9IG5ldyBGb28oKTtcclxuXHJcbiAgICAgICAgbWFwLnNldChmb28sIGJvbyk7XHJcbiAgICAgICAgbWFwLnNldChib28yLCBmb28pO1xyXG5cclxuICAgICAgICBzZXIucmVnaXN0ZXJLbm93blR5cGUoXCJGb29cIiwgRm9vKTtcclxuXHJcbiAgICAgICAgbGV0IG1hcFN0ciA9IHNlci5zdHJpbmdpZnkobWFwKTtcclxuICAgICAgICBsZXQgbWFwMiA9IHNlci5wYXJzZShtYXBTdHIpO1xyXG5cclxuICAgICAgICBhc3NlcnQuZXF1YWwoY29uc3RydWN0ZWQsIDEpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChtYXAyLnNpemUsIDIpO1xyXG5cclxuICAgICAgICBsZXQgZm9vVmFsdWUgPSBudWxsO1xyXG4gICAgICAgIGxldCBmb29LZXkgPSBudWxsO1xyXG4gICAgICAgIG1hcDIuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAoa2V5IGluc3RhbmNlb2YgQm9vKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQub2sodmFsdWUgaW5zdGFuY2VvZiBGb28gJiYgISh2YWx1ZSBpbnN0YW5jZW9mIEJvbykpO1xyXG4gICAgICAgICAgICAgICAgZm9vVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChrZXkgaW5zdGFuY2VvZiBGb28pIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydC5vayh2YWx1ZSBpbnN0YW5jZW9mIEJvbyk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwodmFsdWUuYm9vLCBcImJvb1wiKTtcclxuICAgICAgICAgICAgICAgIGZvb0tleSA9IGtleTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydC5mYWlsKFwiVGhpcyBpcyBub3QgcG9zc2libGUuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFzc2VydC5zdHJpY3RFcXVhbChmb29LZXksIGZvb1ZhbHVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KFwic2hvdWxkIHN1cHBvcnQgTWFwXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgbWFwID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIG1hcC5zZXQoXCJhXCIsIFwiYlwiKTtcclxuICAgICAgICBtYXAuc2V0KFwiY1wiLCBcImRcIik7XHJcbiAgICAgICAgbGV0IHNlciA9IG5ldyBTZXJpYWxpemVyKCk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBzZXIudG9KU09OKG1hcCk7XHJcbiAgICAgICAgbGV0IG90aGVyTWFwID0gc2VyLmZyb21KU09OKGRhdGEpO1xyXG4gICAgICAgIGFzc2VydC5vayhvdGhlck1hcCBpbnN0YW5jZW9mIE1hcCk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKG90aGVyTWFwLnNpemUsIDIpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChvdGhlck1hcC5nZXQoXCJhXCIpLCBtYXAuZ2V0KFwiYVwiKSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKG90aGVyTWFwLmdldChcImNcIiksIG1hcC5nZXQoXCJjXCIpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KFwic2hvdWxkIHN1cHBvcnQgU2V0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgc2V0ID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHNldC5hZGQoXCJhXCIpO1xyXG4gICAgICAgIHNldC5hZGQoXCJiXCIpO1xyXG4gICAgICAgIHNldC5hZGQoXCJjXCIpO1xyXG4gICAgICAgIHNldC5hZGQoW1wiZFwiLCB7IGU6IFwiZlwiIH1dKTtcclxuICAgICAgICBsZXQgc2VyID0gbmV3IFNlcmlhbGl6ZXIoKTtcclxuICAgICAgICBsZXQgZGF0YSA9IHNlci50b0pTT04oc2V0KTtcclxuICAgICAgICBsZXQgb3RoZXJTZXQgPSBzZXIuZnJvbUpTT04oZGF0YSk7XHJcbiAgICAgICAgYXNzZXJ0Lm9rKG90aGVyU2V0IGluc3RhbmNlb2YgU2V0KTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwob3RoZXJTZXQuc2l6ZSwgNCk7XHJcbiAgICAgICAgYXNzZXJ0KG90aGVyU2V0LmhhcyhcImFcIikpO1xyXG4gICAgICAgIGFzc2VydChvdGhlclNldC5oYXMoXCJiXCIpKTtcclxuICAgICAgICBhc3NlcnQob3RoZXJTZXQuaGFzKFwiY1wiKSk7XHJcbiAgICAgICAgbGV0IGFsbCA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2Ygb3RoZXJTZXQudmFsdWVzKCkpIHtcclxuICAgICAgICAgICAgYWxsLnB1c2goaXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBvYmogPSBfKGFsbCkuZmlsdGVyKGZ1bmN0aW9uKGkpIHsgcmV0dXJuIF8uaXNBcnJheShpKTsgfSkuZmlyc3QoKTtcclxuICAgICAgICBhc3NlcnQoXy5pc0FycmF5KG9iaikpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChvYmpbMF0sIFwiZFwiKTtcclxuICAgICAgICBhc3NlcnQoXy5pc09iamVjdChvYmpbMV0pKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwob2JqWzFdLmUsIFwiZlwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KFwic2hvdWxkIHN1cHBvcnQgRGF0ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IG9iaiA9IHtcclxuICAgICAgICAgICAgYTogbmV3IERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHNlciA9IG5ldyBTZXJpYWxpemVyKCk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBzZXIudG9KU09OKG9iaik7XHJcbiAgICAgICAgbGV0IG90aGVyT2JqID0gc2VyLmZyb21KU09OKGRhdGEpO1xyXG4gICAgICAgIGFzc2VydChfLmlzUGxhaW5PYmplY3Qob3RoZXJPYmopKTtcclxuICAgICAgICBhc3NlcnQoXy5pc0RhdGUob3RoZXJPYmouYSkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChvdGhlck9iai5hLmdldFRpbWUoKSwgb2JqLmEuZ2V0VGltZSgpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KFwic2hvdWxkIHN1cHBvcnQgUmVnZXhcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGxldCBvYmogPSB7XHJcbiAgICAgICAgICAgIGE6IC9hYmMvZ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHNlciA9IG5ldyBTZXJpYWxpemVyKCk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBzZXIudG9KU09OKG9iaik7XHJcbiAgICAgICAgbGV0IG90aGVyT2JqID0gc2VyLmZyb21KU09OKGRhdGEpO1xyXG4gICAgICAgIGFzc2VydChfLmlzUGxhaW5PYmplY3Qob3RoZXJPYmopKTtcclxuICAgICAgICBhc3NlcnQoXy5pc1JlZ0V4cChvdGhlck9iai5hKSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKG90aGVyT2JqLmEudG9TdHJpbmcoKSwgb2JqLmEudG9TdHJpbmcoKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdChcInNob3VsZCBzZXJpYWxpemUgZnVuY3Rpb25zXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBmID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIkhlbGxvIVwiO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IHNlciA9IG5ldyBTZXJpYWxpemVyKCk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBzZXIudG9KU09OKGYpO1xyXG4gICAgICAgIGFzc2VydChfLmlzUGxhaW5PYmplY3QoZGF0YSkpO1xyXG4gICAgICAgIGxldCBvdGhlckYgPSBzZXIuZnJvbUpTT04oZGF0YSk7XHJcbiAgICAgICAgYXNzZXJ0KF8uaXNGdW5jdGlvbihvdGhlckYpKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoXCJIZWxsbyFcIiwgb3RoZXJGKCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoXCJzaG91bGQgc2VyaWFsaXplIGZ1bmN0aW9uIHByb3BlcnRpZXNcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGYgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiSGVsbG8hXCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBsZXQgb2JqID0geyBmOiBmIH07XHJcbiAgICAgICAgbGV0IHNlciA9IG5ldyBTZXJpYWxpemVyKCk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBzZXIudG9KU09OKG9iaik7XHJcbiAgICAgICAgYXNzZXJ0KF8uaXNQbGFpbk9iamVjdChkYXRhKSk7XHJcbiAgICAgICAgbGV0IG90aGVyT2JqID0gc2VyLmZyb21KU09OKGRhdGEpO1xyXG4gICAgICAgIGFzc2VydChfLmlzRnVuY3Rpb24ob3RoZXJPYmouZikpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChcIkhlbGxvIVwiLCBvdGhlck9iai5mKCkpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXX0=
